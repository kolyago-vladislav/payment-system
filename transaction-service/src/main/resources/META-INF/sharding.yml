dataSources:
  ds_0:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    driverClassName: org.postgresql.Driver
    jdbcUrl: jdbc:postgresql://localhost:5436/transaction_shard_0?currentSchema=transaction&stringtype=unspecified&options=-c%20TimeZone=UTC
    username: postgres
    password: postgres
  ds_1:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    driverClassName: org.postgresql.Driver
    jdbcUrl: jdbc:postgresql://localhost:5435/transaction_shard_1?currentSchema=transaction&stringtype=unspecified&options=-c%20TimeZone=UTC
    username: postgres
    password: postgres

rules:
  - !SHARDING
    tables:
      transactions:
        actualDataNodes: ds_${0..1}.transactions
        databaseStrategy:
          standard:
            shardingColumn: user_id
            shardingAlgorithmName: user-id-mod
      outbox_events:
        actualDataNodes: ds_${0..1}.outbox_events
        databaseStrategy:
          standard:
            shardingColumn: user_id
            shardingAlgorithmName: user-id-mod
      wallets:
        actualDataNodes: ds_${0..1}.wallets
        databaseStrategy:
          standard:
            shardingColumn: user_id
            shardingAlgorithmName: user-id-mod
    shardingAlgorithms:
      user-id-mod:
        type: UUID_MOD
        props:
          sharding-count: 2
  - !BROADCAST
    tables:
      - wallet_types
